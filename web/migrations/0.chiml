ins: action, config
out: output
vars:
  schemas:
    - name: 'cck'
      collectionName: 'web_cck'
      fields:
        name: 'text'
        collectionName: 'text'
        site: 'text'
        fields: 'textArea'
    - name: 'routes'
      collectionName: 'web_routes'
      fields:
        name: 'text'
        url: 'text'
        chiml: 'text'
    - name: 'users'
      collectionName: 'web_users'
      fields:
        username: 'text'
        email: 'text'
        hashedPassword: 'text'
        groups: 'textArea'
    - name: 'configs'
      collectionName: 'web_configs'
      fields:
        key: 'text'
        value: 'text'
do:
  - |cckPath <-- config.cckPath

  - if: action == 'up'
    do:
      # upgrade
      - |(schemas) -> [$.loadJs(cckPath, 'createSchema')]

    else:
      # downgrade
      # - |(configs.collectionName, 'remove', {}) -> [$.loadJs(cckPath, 'mongoExecute')]
      - |(schemas) -> [$.loadJs(cckPath, 'removeSchema')]
