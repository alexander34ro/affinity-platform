<% if (config.showTopNav) { %>
  <nav class="navbar <%= config.bootstrapNavClass? config.bootstrapNavClass : 'navbar-default' %>">
    <div class="container-fluid">

      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/"><%= config.title %></a>
      </div>

      <div id="navbar" class="navbar-collapse collapse">

        <ul class="nav navbar-nav">
          <% for (let navigation of config.navigation) { %>
            <% if (!isAuthorized(request.auth, navigation.groups)) {continue; } %>

            <% if ('url' in navigation) { %>
              <!-- Navigation -->
              <li class="<%= navigation.url === request.url ? 'active' : '' %>"><a href="<%= navigation.url %>"><%- navigation.caption %></a></li>
            <% } else { %>

              <!-- Dropdown -->
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><%- navigation.caption %> <span class="caret"></span></a>
                <ul class="dropdown-menu">
                  <% for (let subNavigation of navigation.children) { %>
                    <% if (!isAuthorized(request.auth, subNavigation.groups)) {continue; } %>
                    <% if ('url' in subNavigation) { %>
                      <li class="<%= subNavigation.url === request.url ? 'active' : '' %>">
                        <a href="<%= subNavigation.url %>"><%- subNavigation.caption %></a>
                      </li>
                    <% } %>
                  <% } %>
                </ul>
              </li>

            <% } %>

          <% } %>
        </ul>

        <ul class="nav navbar-nav navbar-right">
          <% if (request.auth.username){ %>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                <%= request.auth.username %> <span class="caret" ></span>
              </a>
              <ul class="dropdown-menu">
                <li><a href="/logout">Logout</a></li>
              </ul>
            </li>
          <% } else { %>
            <li><a href="/login">Login</a></li>
          <% } %>
        </ul>

      </div><!--/.nav-collapse -->
    </div><!--/.container-fluid -->
  </nav>
<% } %>
<% if (config.showJumbotron) { %>
  <%- config.jumbotron %>
<% } %>
